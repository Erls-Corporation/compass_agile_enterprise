<div id='<%=@uuid%>' style='width:500px;height:500px;border:solid 1px black;'></div>
<script type='text/javascript'>
  //we do not want to load google libraries more than once.
  if(!window.mapJsLoaded){
    window.loadMap_<%=@uuid%> = function(){
      var geocoder = new google.maps.Geocoder();
      geocoder.geocode( { 'address': '<%=@address%>'}, function(results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
          var myOptions = {
            zoom: 18,
            center: results[0].geometry.location,
            mapTypeId: google.maps.MapTypeId.SATELLITE
          };
          var map = new google.maps.Map(document.getElementById('<%=@uuid%>'),myOptions);
          var marker = new google.maps.Marker({
            map: map,
            title: '<%=@title%>',
            position: results[0].geometry.location
          });
        } else {
          alert('Geocode was not successful for the following reason: ' + status);
        }
      });
    }
    Compass.ErpApp.Utility.JsLoader.load("http://maps.google.com/maps/api/js?sensor=false&callback=loadMap_<%=@uuid%>", false);
    window.mapJsLoaded = true;
  }
  else{
    function loadMap_<%=@uuid%>(){
      var geocoder = new google.maps.Geocoder();
      geocoder.geocode( { 'address': '<%=@address%>'}, function(results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
          var myOptions = {
            zoom: 18,
            center: results[0].geometry.location,
            mapTypeId: google.maps.MapTypeId.SATELLITE
          };
          var map = new google.maps.Map(document.getElementById('<%=@uuid%>'),myOptions);
          var marker = new google.maps.Marker({
            map: map,
            title: '<%=@title%>',
            position: results[0].geometry.location
          });
        }
        else{
          alert('Geocode was not successful for the following reason: ' + status);
        }
      });
    }
    setTimeout(loadMap_<%=@uuid%>,1000);
  }
</script>